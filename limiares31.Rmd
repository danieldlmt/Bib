---
title: "limiares"
output: html_document
---

```{r setup, include=FALSE, results="asis", echo=FALSE,message=FALSE,warning=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr, warn.conflicts = FALSE)
library(venn)
library(stringr)
library(knitr)
library(ggplot2)
library(trend)
logs <- data.frame(sistema=c("Allegro", "SDL","SFML","Coco2dx"), caminho = c('~/bib/log_allegro.R', '~/bib/log_SDL.R', '~/bib/log_SFML.R', '~/bib/log_coco2dx.R'),ws_analise=c('~/bib/analise_allegro.RData', '~/bib/analise_SDL.RData', '~/bib/analise_SFML.RData', '~/bib/analise_coco2dx.RData'), ws_analisetemporal = c('~/bib/analisetemporal_allegro.RData', '~/bib/analisetemporal_SDL.RData', '~/bib/analisetemporal_SFML.RData', '~/bib/analisetemporal_coco2dx.RData'), ws_analisetemporaljanela = c('~/bib/analisetemporaljanela_allegro.RData', '~/bib/analisetemporaljanela_SDL.RData', '~/bib/analisetemporaljanela_SFML.RData', '~/bib/analisetemporaljanela_coco2dx.RData')  )
load ("analise_allegro.RData")
```



```{r results="asis", echo=FALSE,message=FALSE,warning=FALSE}
for (it in 1:length(logs$sistema)){
  aux<-it
  #cat("  \n###",  as.character( logs$sistema[it] ) ,"\n")
  rm(list = ls()[!ls() %in% c("logs","it")])
  #source(as.character(logs$caminho[it]) , verbose=FALSE)
  #source( '~/bib/analise.R', echo=FALSE, verbose=FALSE, prompt.echo=FALSE)
  load (as.character(logs$ws_analisetemporaljanela[it]))


    
        cat("\n\n####",  as.character( logs$sistema[it] ) ,"\n")
         cat("\n",  as.character( "0.1") ,"\n")
         
         
        print("<div align='center'>")
        cat ("\n\n#### Evolução dos desenvolvedores ao longo do tempo \n( janela 24 semanas, iteracao de 4 semanas)\n")
        print("</div>")
        

  esp <- esp_bind%>% filter(prob==0.1)  
  gen <-gen_bind%>% filter(prob==0.1)  
  espgen <- espgen_bind%>% filter(prob==0.1)   
 
  par(mar=c(5.1, 5, 4.1, 2.1)) 
  plot(esp$iteracao,esp$porc,col="red",type = "l",ylim = c(0,100),xlim=c(1,j), xlab = "Tempo (semanas)", ylab = "% de desenvolvedores",cex.names = 1.7,cex.axis = 1.7,cex.lab=1.7)
  lines(gen$iteracao,gen$porc,col="green",type = "l" )
  lines(espgen$iteracao,espgen$porc,col="black",type = "l" )
  legend("top",c("Especialista", "Generalista", "Especialista e Generalista"), col=c("red","green","black"),lty=1)

 esptwo <- mk.test(esp$porc, alternative = c("two.sided"), continuity = TRUE)
 espup <- mk.test(esp$porc, alternative = c("greater"), continuity = TRUE)
 espdown <- mk.test(esp$porc, alternative = c("less"), continuity = TRUE)
 gentwo <- mk.test(gen$porc, alternative = c("two.sided"), continuity = TRUE)
 genup <- mk.test(gen$porc, alternative = c("greater"), continuity = TRUE)
 gendown <- mk.test(gen$porc, alternative = c("less"), continuity = TRUE)
 espgentwo <- mk.test(espgen$porc, alternative = c("two.sided"), continuity = TRUE)
 espgennup <- mk.test(espgen$porc, alternative = c("greater"), continuity = TRUE)
 espgendown <- mk.test(espgen$porc, alternative = c("less"), continuity = TRUE)
aux<-data.frame(esp = c(as.numeric(esptwo["p.value"]),as.numeric(espup["p.value"]),as.numeric(espdown["p.value"])),
               gen = c(as.numeric(gentwo["p.value"]),as.numeric(genup["p.value"]),as.numeric(gendown["p.value"])),
               espgen = c(as.numeric(espgentwo["p.value"]),as.numeric(espgennup["p.value"]),as.numeric(espgendown["p.value"])),
               row.names = c("twosided", "greater", "less"))
 
   print(kable(aux))
  # P value < 0.05 means that there is a monotonic trend 
 
   
   
        cat("\n")
        
       
        
        
        
        
        
        
        
        
         
        
         cat("\n\n####",  as.character( logs$sistema[it] ) ,"\n")
         cat("\n",  as.character( "0.2") ,"\n")
         
         
        print("<div align='center'>")
        cat ("\n\n#### Evolução dos desenvolvedores ao longo do tempo \n( janela 24 semanas, iteracao de 4 semanas)\n")
        print("</div>")       
        
    esp <- esp_bind%>% filter(prob==0.2)     
  gen <-gen_bind%>% filter(prob==0.2)  
  espgen <- espgen_bind%>% filter(prob==0.2)   
 
   par(mar=c(5.1, 5, 4.1, 2.1)) 
  plot(esp$iteracao,esp$porc,col="red",type = "l",ylim = c(0,100),xlim=c(1,j), xlab = "Tempo (semanas)", ylab = "% de desenvolvedores",cex.names = 1.7,cex.axis = 1.7,cex.lab=1.7)
  lines(gen$iteracao,gen$porc,col="green",type = "l" )
  lines(espgen$iteracao,espgen$porc,col="black",type = "l" )
  legend("top",c("Especialista", "Generalista", "Especialista e Generalista"), col=c("red","green","black"),lty=1)

 esptwo <- mk.test(esp$porc, alternative = c("two.sided"), continuity = TRUE)
 espup <- mk.test(esp$porc, alternative = c("greater"), continuity = TRUE)
 espdown <- mk.test(esp$porc, alternative = c("less"), continuity = TRUE)
 gentwo <- mk.test(gen$porc, alternative = c("two.sided"), continuity = TRUE)
 genup <- mk.test(gen$porc, alternative = c("greater"), continuity = TRUE)
 gendown <- mk.test(gen$porc, alternative = c("less"), continuity = TRUE)
 espgentwo <- mk.test(espgen$porc, alternative = c("two.sided"), continuity = TRUE)
 espgennup <- mk.test(espgen$porc, alternative = c("greater"), continuity = TRUE)
 espgendown <- mk.test(espgen$porc, alternative = c("less"), continuity = TRUE)
aux<-data.frame(esp = c(as.numeric(esptwo["p.value"]),as.numeric(espup["p.value"]),as.numeric(espdown["p.value"])),
               gen = c(as.numeric(gentwo["p.value"]),as.numeric(genup["p.value"]),as.numeric(gendown["p.value"])),
               espgen = c(as.numeric(espgentwo["p.value"]),as.numeric(espgennup["p.value"]),as.numeric(espgendown["p.value"])),
               row.names = c("twosided", "greater", "less"))
 
   print(kable(aux))
        cat("\n")      

        
        
        
        
        
        
        
        
        
        
        
                
           cat("\n\n####",  as.character( logs$sistema[it] ) ,"\n")
         cat("\n",  as.character( "0.3") ,"\n")
         
         
        print("<div align='center'>")
        cat ("\n\n#### Evolução dos desenvolvedores ao longo do tempo \n( janela 24 semanas, iteracao de 4 semanas)\n")
        print("</div>")
        
     esp <- esp_bind%>% filter(prob==0.3)     
  gen <-gen_bind%>% filter(prob==0.3)  
  espgen <- espgen_bind%>% filter(prob==0.3)   
 
   par(mar=c(5.1, 5, 4.1, 2.1)) 
  plot(esp$iteracao,esp$porc,col="red",type = "l",ylim = c(0,100),xlim=c(1,j), xlab = "Tempo (semanas)", ylab = "% de desenvolvedores",cex.names = 1.7,cex.axis = 1.7,cex.lab=1.7)
  lines(gen$iteracao,gen$porc,col="green",type = "l" )
  lines(espgen$iteracao,espgen$porc,col="black",type = "l" )
  legend("top",c("Especialista", "Generalista", "Especialista e Generalista"), col=c("red","green","black"),lty=1)

 esptwo <- mk.test(esp$porc, alternative = c("two.sided"), continuity = TRUE)
 espup <- mk.test(esp$porc, alternative = c("greater"), continuity = TRUE)
 espdown <- mk.test(esp$porc, alternative = c("less"), continuity = TRUE)
 gentwo <- mk.test(gen$porc, alternative = c("two.sided"), continuity = TRUE)
 genup <- mk.test(gen$porc, alternative = c("greater"), continuity = TRUE)
 gendown <- mk.test(gen$porc, alternative = c("less"), continuity = TRUE)
 espgentwo <- mk.test(espgen$porc, alternative = c("two.sided"), continuity = TRUE)
 espgennup <- mk.test(espgen$porc, alternative = c("greater"), continuity = TRUE)
 espgendown <- mk.test(espgen$porc, alternative = c("less"), continuity = TRUE)
aux<-data.frame(esp = c(as.numeric(esptwo["p.value"]),as.numeric(espup["p.value"]),as.numeric(espdown["p.value"])),
               gen = c(as.numeric(gentwo["p.value"]),as.numeric(genup["p.value"]),as.numeric(gendown["p.value"])),
               espgen = c(as.numeric(espgentwo["p.value"]),as.numeric(espgennup["p.value"]),as.numeric(espgendown["p.value"])),
               row.names = c("twosided", "greater", "less"))
 
   print(kable(aux))
        cat("\n")   
        
        
        
        
        
        
        
        
        
        
        
        
            cat("\n\n####",  as.character( logs$sistema[it] ) ,"\n")
         cat("\n",  as.character( "0.4") ,"\n")
         
         
        print("<div align='center'>")
        cat ("\n\n#### Evolução dos desenvolvedores ao longo do tempo \n( janela 24 semanas, iteracao de 4 semanas)\n")
        print("</div>")    
        
         esp <- esp_bind%>% filter(prob==0.4)     
  gen <-gen_bind%>% filter(prob==0.4)  
  espgen <- espgen_bind%>% filter(prob==0.4)   
 
   par(mar=c(5.1, 5, 4.1, 2.1)) 
  plot(esp$iteracao,esp$porc,col="red",type = "l",ylim = c(0,100), xlim=c(1,j),xlab = "Tempo (semanas)", ylab = "% de desenvolvedores",cex.names = 1.7,cex.axis = 1.7,cex.lab=1.7)
  lines(gen$iteracao,gen$porc,col="green",type = "l" )
  lines(espgen$iteracao,espgen$porc,col="black",type = "l" )
  legend("top",c("Especialista", "Generalista", "Especialista e Generalista"), col=c("red","green","black"),lty=1)

 esptwo <- mk.test(esp$porc, alternative = c("two.sided"), continuity = TRUE)
 espup <- mk.test(esp$porc, alternative = c("greater"), continuity = TRUE)
 espdown <- mk.test(esp$porc, alternative = c("less"), continuity = TRUE)
 gentwo <- mk.test(gen$porc, alternative = c("two.sided"), continuity = TRUE)
 genup <- mk.test(gen$porc, alternative = c("greater"), continuity = TRUE)
 gendown <- mk.test(gen$porc, alternative = c("less"), continuity = TRUE)
 espgentwo <- mk.test(espgen$porc, alternative = c("two.sided"), continuity = TRUE)
 espgennup <- mk.test(espgen$porc, alternative = c("greater"), continuity = TRUE)
 espgendown <- mk.test(espgen$porc, alternative = c("less"), continuity = TRUE)
aux<-data.frame(esp = c(as.numeric(esptwo["p.value"]),as.numeric(espup["p.value"]),as.numeric(espdown["p.value"])),
               gen = c(as.numeric(gentwo["p.value"]),as.numeric(genup["p.value"]),as.numeric(gendown["p.value"])),
               espgen = c(as.numeric(espgentwo["p.value"]),as.numeric(espgennup["p.value"]),as.numeric(espgendown["p.value"])),
               row.names = c("twosided", "greater", "less"))
 
   print(kable(aux))
        cat("\n") 
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
         cat("\n\n####",  as.character( logs$sistema[it] ) ,"\n")
         cat("\n",  as.character( "0.5") ,"\n")
         
         
        print("<div align='center'>")
        cat ("\n\n#### Evolução dos desenvolvedores ao longo do tempo \n( janela 24 semanas, iteracao de 4 semanas)\n")
        print("</div>")       
        
    esp <- esp_bind%>% filter(prob==0.5)     
  gen <-gen_bind%>% filter(prob==0.5)  
  espgen <- espgen_bind%>% filter(prob==0.5)   
 
   par(mar=c(5.1, 5, 4.1, 2.1)) 
  plot(esp$iteracao,esp$porc,col="red",type = "l",ylim = c(0,100),xlim=c(1,j), xlab = "Tempo (semanas)", ylab = "% de desenvolvedores",cex.names = 1.7,cex.axis = 1.7,cex.lab=1.7)
  lines(gen$iteracao,gen$porc,col="green",type = "l" )
  lines(espgen$iteracao,espgen$porc,col="black",type = "l" )
  legend("top",c("Especialista", "Generalista", "Especialista e Generalista"), col=c("red","green","black"),lty=1)

 esptwo <- mk.test(esp$porc, alternative = c("two.sided"), continuity = TRUE)
 espup <- mk.test(esp$porc, alternative = c("greater"), continuity = TRUE)
 espdown <- mk.test(esp$porc, alternative = c("less"), continuity = TRUE)
 gentwo <- mk.test(gen$porc, alternative = c("two.sided"), continuity = TRUE)
 genup <- mk.test(gen$porc, alternative = c("greater"), continuity = TRUE)
 gendown <- mk.test(gen$porc, alternative = c("less"), continuity = TRUE)
 espgentwo <- mk.test(espgen$porc, alternative = c("two.sided"), continuity = TRUE)
 espgennup <- mk.test(espgen$porc, alternative = c("greater"), continuity = TRUE)
 espgendown <- mk.test(espgen$porc, alternative = c("less"), continuity = TRUE)
aux<-data.frame(esp = c(as.numeric(esptwo["p.value"]),as.numeric(espup["p.value"]),as.numeric(espdown["p.value"])),
               gen = c(as.numeric(gentwo["p.value"]),as.numeric(genup["p.value"]),as.numeric(gendown["p.value"])),
               espgen = c(as.numeric(espgentwo["p.value"]),as.numeric(espgennup["p.value"]),as.numeric(espgendown["p.value"])),
               row.names = c("twosided", "greater", "less"))
 
   print(kable(aux))
        cat("\n")      
        

        

    
}
```

